DrawLine={AttributeGroup:[],LineGroup:[],table:!1,check:function(t){return/^(charball|cbg)/i.test(t.className)},on_off:!0,bind:function(t,i){return this.table=t,this.on_off=i,this},color:function(t){return LG.color=t,this},draw:function(t){if(this.table){if(t)for(var i=this.AttributeGroup.length,e=0;e<i;e++){var n=this.AttributeGroup[e];LG.color=n.color,JoinLine.indent=n.indent,this.LineGroup.push(new LG(this.table,n[0],n[1],n[2],n[3],this.check))}if(this.on_off){var o=this,s=document.getElementById(this.on_off);s&&(s.onclick=function(){o.show(this.checked)})}return this}},show:function(t){for(var i=this.LineGroup.length,e=0;e<i;e++)this.LineGroup[e].show(t)},add:function(t,i,e,n){return this.AttributeGroup.push([t,i,e,n]),this.AttributeGroup[this.AttributeGroup.length-1].color=LG.color,this.AttributeGroup[this.AttributeGroup.length-1].indent=JoinLine.indent,this}},JoinLine=function(t,i){this.color=t||"#000000",this.size=i||1,this.lines=[],this.tmpDom=null,this.visible=!0},JoinLine.prototype={show:function(t){for(var i=0;i<this.lines.length;i++)this.lines[i].style.visibility=t?"visible":"hidden"},remove:function(){for(var t=0;t<this.lines.length;t++)this.lines[t].parentNode.removeChild(this.lines[t]);this.lines=[]},join:function(t,i){this.remove(),this.visible=i?"visible":"hidden",this.tmpDom=document.createDocumentFragment();for(var e=0;e<t.length-1;e++){var n=this.pos(t[e]),o=this.pos(t[e+1]);this.FFLine(n.x,n.y,o.x,o.y)}document.body.appendChild(this.tmpDom)},pos:function(t){if(void 0==t.nodeType)return t;for(var i={x:0,y:0},e=t;e;e=e.offsetParent)i.x+=e.offsetLeft,i.y+=e.offsetTop;return i.x+=parseInt(t.offsetWidth/2),i.y+=parseInt(t.offsetHeight/2),i},FFLine:function(t,i,e,n){if(!(Math.abs(i-n)<2*JoinLine.indent&&t==e)){var o=this.nPos(t,i,e,n,JoinLine.indent);t=o[0],i=o[1],e=o[2],n=o[3];var s=document.createElement("canvas");s.style.position="absolute",s.style.visibility=this.visible,s.width=Math.abs(t-e)||this.size,s.height=Math.abs(i-n)||this.size;var h=Math.min(i,n),r=Math.min(t,e);s.style.top=h+"px",s.style.left=r+"px";var l=s.getContext("2d");l.save(),l.strokeStyle=this.color,l.lineWidth=this.size,l.globalAlpha=1,l.beginPath(),l.moveTo(t-r,i-h),l.lineTo(e-r,n-h),l.closePath(),l.stroke(),l.restore(),this.lines.push(s),this.tmpDom.appendChild(s)}},IELine:function(t,i,e,n){if(!(Math.abs(i-n)<2*JoinLine.indent&&t==e))try{var o=this.nPos(t,i,e,n,JoinLine.indent);t=o[0],i=o[1],e=o[2],n=o[3];var s=document.createElement("esun:line");this.lines.push(s),this.tmpDom.appendChild(s),s.className="IELine",s.style.cssText="z-index:99;position:absolute;left:0;top:0",s.style.behavior="url(#default#VML)",s.style.visibility=this.visible,s.from=t+","+i,s.to=e+","+n,s.strokeColor=this.color,s.strokeWeight=this.size+"px",s.coordOrigin="0,0"}catch(t){}},nPos:function(t,i,e,n,o){var s=t-e,h=i-n,r=Math.round(Math.sqrt(Math.pow(s,2)+Math.pow(h,2))),l=Math.round(s*o/r),a=Math.round(h*o/r);return[e+l,n+a,t-l,i-a]}},JoinLine.indent=8,LG=function(t,i,e,n,o,s){var h={x:i||0,y:e||0,w:n||0,oh:o||0},r=document.getElementById(t).rows,l=h.y<0?r.length+h.y:h.y,a=r.length-h.oh,u=h.x<0?r[l].cells.length+h.x:h.x,c=u+h.w;c>r[l].cells.length&&(c=r[l].cells.length),0==h.w&&(c=r[l].cells.length),this.g=[];for(var f=l;f<a;f++)for(var d=r[f].cells,p=u;p<c;p++){var v=d[p];v&&s(v,p,f)===!0&&this.g.push(v)}LG.autoDraw&&this.draw()},LG.color="#E4A8A8",LG.size=2,LG.autoDraw=!0,LG.isShow=!0,LG.prototype={draw:function(){this.line=new JoinLine(LG.color,LG.size),this.line.join(this.g,LG.isShow)},show:function(t){this.line.show(t)}},Chart={},Chart.on=function(t,i,e){t.attachEvent?t.attachEvent("on"+i,function(){e.call(t)}):t.addEventListener(i,e,!1)},Chart.ini={default_has_line:!0},Chart.init=function(){if(Chart.ini.default_has_line){var t=document.getElementById("has_line");t&&(t.checked="checked")}},fw={},fw.onReady=function(t){Chart.on(window,"load",t)};